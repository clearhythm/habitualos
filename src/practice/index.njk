---
title: Practice - HabitualOS
layout: base.njk
permalink: /practice/
---

<div style="max-width: 800px; margin: 4rem auto; padding: 2rem; text-align: center;">
  <h1 id="rank-title"><span id="rank-emoji"></span> <span id="rank-name">&nbsp;</span></h1>
  <p style="font-size: 1.2rem; color: #666; margin: 0 0 2rem 0;" id="rank-subtitle">
    Loading...
  </p>

  <!-- Practice Action Cards -->
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 3rem 0;">
    <!-- Get Motivated Card -->
    <a href="/practice/chat/" style="text-decoration: none; color: inherit;">
      <div style="padding: 3rem 2rem; border: 2px solid #ddd; border-radius: 12px; transition: all 0.2s;"
           onmouseover="this.style.borderColor='#9b59b6'"
           onmouseout="this.style.borderColor='#ddd'">
        <div style="font-size: 3rem; margin-bottom: 1rem;">üêâ</div>
        <h2 style="margin: 0 0 1rem 0; font-size: 1.5rem;">Motivate</h2>
        <p style="color: #666; margin: 0;">Obi-Wai is here to help.<br/>Choose a practice, get motivated.</p>
      </div>
    </a>

    <!-- Log Practice Card -->
    <a href="/practice/log/" style="text-decoration: none; color: inherit;">
      <div style="padding: 3rem 2rem; border: 2px solid #ddd; border-radius: 12px; transition: all 0.2s;"
           onmouseover="this.style.borderColor='#0066cc'"
           onmouseout="this.style.borderColor='#ddd'">
        <div style="font-size: 3rem; margin-bottom: 1rem;">ü™µ</div>
        <h2 style="margin: 0 0 1rem 0; font-size: 1.5rem;">Log Practice</h2>
        <p style="color: #666; margin: 0;">Share what you did.<br/>Learn from what you share.</p>
      </div>
    </a>
  </div>

  <!-- Mobile responsive: Stack cards on small screens -->
  <style>
    @media (max-width: 600px) {
      div[style*="grid-template-columns: 1fr 1fr"] {
        grid-template-columns: 1fr !important;
      }
    }
  </style>

  <!-- Entries Section -->
  <h2 style="margin-top: 3rem; margin-bottom: 1rem; font-size: 1.25rem;">Your Habits</h2>
  <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center; padding: 2rem 1rem; background: #f9f9f9; border-radius: 8px;">
    <!-- Check-ins Stat -->
    <a href="/practice/history/" style="text-decoration: none; text-align: center; color: inherit;">
      <div style="font-size: 2rem; font-weight: 600; color: #333; margin-bottom: 0.25rem;" id="checkins-count">--</div>
      <div style="font-size: 0.9rem; color: #666; margin-bottom: 0.5rem;">check-ins</div>
      <div style="font-size: 0.85rem; color: #0066cc; text-decoration: underline;">view &gt;</div>
    </a>

    <!-- Vertical Divider -->
    <div style="width: 1px; height: 60px; background: #ddd;"></div>

    <!-- Practices Stat -->
    <a href="/practice/library/" style="text-decoration: none; text-align: center; color: inherit;">
      <div style="font-size: 2rem; font-weight: 600; color: #333; margin-bottom: 0.25rem;" id="practices-count">--</div>
      <div style="font-size: 0.9rem; color: #666; margin-bottom: 0.5rem;">practices</div>
      <div style="font-size: 0.85rem; color: #0066cc; text-decoration: underline;">view &gt;</div>
    </a>
  </div>
</div>

<script type="module">
  import { initializeUser } from '/assets/js/auth/auth.js';

  // Initialize userId
  const userId = initializeUser();

  // Calculate rank based on check-ins
  function getRank(checkins) {
    if (checkins === 0) return { name: 'Seed', emoji: 'üå±' };
    if (checkins < 5) return { name: 'Sprout', emoji: 'üåø' };
    if (checkins < 20) return { name: 'Sapling', emoji: 'üå≥' };
    if (checkins < 50) return { name: 'Tree', emoji: 'üå≤' };
    return { name: 'Grove', emoji: 'üèûÔ∏è' };
  }

  // Load stats
  async function loadStats() {
    try {
      const response = await fetch(`/.netlify/functions/practice-list?userId=${userId}&_=${Date.now()}`, {
        cache: 'no-store'
      });

      const data = await response.json();

      if (data.success) {
        // data.practices is now the practice library (unique practices)
        // Each practice has a checkins counter
        const totalCheckins = data.practices.reduce((sum, p) => sum + (p.checkins || 0), 0);
        const uniquePractices = data.practices.length;

        // Update rank
        const rank = getRank(totalCheckins);
        document.getElementById('rank-emoji').textContent = rank.emoji;
        document.getElementById('rank-name').textContent = rank.name;

        // Update subtitle
        const practicesText = totalCheckins === 1 ? 'practice' : 'practices';
        document.getElementById('rank-subtitle').textContent =
          `You logged ${totalCheckins} ${practicesText}.`;

        // Update stats
        document.getElementById('checkins-count').textContent = totalCheckins;
        document.getElementById('practices-count').textContent = uniquePractices;
      }
    } catch (error) {
      console.error('Error loading stats:', error);
    }
  }

  loadStats();
</script>
